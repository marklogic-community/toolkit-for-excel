<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
     <title>PresentationML Support Module Functions </title>
     <meta name="Homepage" content="server, administration, Mark Logic, xml, xquery, database">
     <meta name="Keywords" content="server, administration, Mark Logic, xml, xquery, database">
     <meta name="Description" content="PresentationML Support Module Functions">
     <link href="images/admin.css" type="text/css" rel="stylesheet">
     <script type="text/javascript" language="javascript" src="images/tree.js"></script>
   </head>
   <div FirebugVersion="1.3.3" style="display: none;" id="_firebugConsole"></div>
   <body>
     <form name="apidocs" action="apidocs.xqy" method="get">
       <input name="fname" value="PresentationML" type="hidden">
        <table width="100%" border="0" cellpadding="0" cellspacing="0" height="400">
	 <tbody>
           <tr>
	     <td class="mainbody" valign="top">
              <table width="100%" border="0" cellpadding="0" cellspacing="0">
               <tbody>
                 <tr style="background-color: rgb(160, 0, 46);" valign="top">
		   <td width="100%" align="left" height="90">
                     <div><img src="images/varspace.gif" alt="" width="178" height="1"></div>
                     <div class="host-details" style="padding-left: 20px; padding-top: 10px;">
                       <div>This page was generated</div>
                       <div>Sept.&nbsp;15,&nbsp;2009</div>
                       <div>11:01&nbsp;PM</div>
                     </div>
                   </td>
		   <td style="background-image: url(images/top-right-right-background.gif); background-repeat: no-repeat;" valign="bottom" width="420" align="left">
                     <div><img src="images/varspace.gif" alt="" width="420" height="1"></div>
                     <div class="page-name" style="text-align: right; padding-right: 8px; padding-bottom: 2px;">XQuery Function Reference</div>
                   </td>
	         </tr>
                 <tr valign="top">
		   <td colspan="3" width="100%" align="left" height="100%">
                    <div><img src="images/varspace.gif" alt="" width="598" height="1"></div>
                    <table width="100%" align="center" cellpadding="4" cellspacing="1">
                      <tbody><tr valign="top">
		        <td>
                          <table width="100%">
			  <tbody>
                            <tr align="center">
			     <td><br>
                              <font size="+1"><b>
                               Module: PresentationML Support
                               </b><br></font>
                               <br>
                             </td>
			    </tr>
                            <tr>
			     <td style="font-family: arial; font-size: 10pt;">
                               <p>The PresentationML function module is installed as the following file:</p>
                               <ul>
			         <li><code><em>install_dir</em>/Modules/MarkLogic/openxml/presentation-ml-support.xqy</code></li>
			       </ul>
                               <p>where <code><em>install_dir</em></code> is the directory in which MarkLogic Server is installed.</p>
                               <p>To use the <code>presentation-ml-support.xqy</code> module in your own XQuery modules, 
                                  include the following line in your XQuery prolog:</p>
                               <p><code>import module namespace ppt="http://marklogic.com/openxml/powerpoint" 
		                         at "/MarkLogic/MarkLogic/openxml/presentation-ml-support.xqy"</code></p>
                               <p>The PresentationML functions are used to manipulate Microsoft Office
                                  Open XML documents.</p>
                               <table class="table-line" width="100%" align="center" bgcolor="#000000" cellpadding="4" cellspacing="1">
				<tbody>
                                  <tr bgcolor="#f2ebce">
			            <td colspan="10">
                                      <font size="+1"><b>Function Summary</b></font>
                                    </td>
				  </tr>
                                  <tr class="mainbody">
			            <td style="font-family: arial; font-size: 10pt;">
                                       <a href="#ppt:directory-uris"><b>ppt:directory-uris</b></a> 
                                    </td>
			            <td style="font-family: arial; font-size: 10pt;">
                                       This function returns URIs for the presentation documents within the specified directory.
                                    </td>
				  </tr>
                                  <tr class="mainbody">
			            <td style="font-family: arial; font-size: 10pt;">
                                       <a href="#ppt:insert-slide"><b>ppt:insert-slide</b></a> 
                                    </td>
			            <td style="font-family: arial; font-size: 10pt;">
                                       This function returns updated map for the presentation, with slides inserted from presentations specified in parameters.
                                    </td>
				  </tr>
                                  <tr class="mainbody">
			            <td style="font-family: arial; font-size: 10pt;">
                                       <a href="#ppt:package-make"><b>ppt:package-make</b></a> 
                                    </td>
			            <td style="font-family: arial; font-size: 10pt;">
                                       This function returns a presentation in the OPC (Open Packaging Convention) format XML. 
                                    </td>
			          </tr>
                                  <tr class="mainbody">
			            <td style="font-family: arial; font-size: 10pt;">
                                       <a href="#ppt:package-map"><b>ppt:package-map</b></a> 
                                    </td>
			            <td style="font-family: arial; font-size: 10pt;">
                                       This function returns a map for the specified presentation.
                                    </td>
			          </tr>
                                  <tr class="mainbody">
			            <td style="font-family: arial; font-size: 10pt;">
                                       <a href="#ppt:package-map-zip"><b>ppt:package-map-zip</b></a> 
                                    </td>
			            <td style="font-family: arial; font-size: 10pt;">
                                       This function returns the zip archive for the documents specified in the map. 
                                    </td>
				  </tr>
			          <!--
                                  <tr class="mainbody">
			            <td style="font-family: arial; font-size: 10pt;">
                                      <a href="#ppt:uri-app-props"><b>
            ppt:uri-app-props
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
	  This function returns URI for docProps/app.xml presentation package part. 
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-content-types"><b>
            ppt:uri-content-types 
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for [Content_Types].xml presentation package part. 
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-core-props"><b>
           ppt:uri-core-props
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for docProps/core.xml presentation package part. 
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-docprops-dir"><b>
           ppt:uri-docprops-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for docProps/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-dir"><b>
            ppt:uri-ppt-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/ presentation package part. 
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-handout-master"><b>
            ppt:uri-ppt-handout-master
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/handoutMasters/handoutMaster#.xml presentation pacakage part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-handout-master-rels"><b>
            ppt:uri-ppt-handout-master-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
	  This function returns URI for ppt/handoutMasters/_rels/handoutMaster#.xml.rels presentation package part.
	  </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-handout-master-rels-dir"><b>
            ppt:uri-ppt-handout-master-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/handoutMasters/_rels/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-handout-masters-dir"><b>
            ppt:uri-ppt-handout-masters-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/handoutMasters/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-media-dir"><b>
            ppt:uri-ppt-media-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/media/ presentation pacakge part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-notes-master"><b>
            ppt:uri-ppt-notes-master
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
            This function returns URI for ppt/notesMasters/notesMaster#.xml presentation package part.
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-notes-master-rels"><b>
            ppt:uri-ppt-notes-master-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
           This function returns URI for ppt/notesMasters/_rels/ presentation package part. 
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-notes-masters-dir"><b>
            ppt:uri-ppt-notes-masters-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
            This function returns URI for ppt/notesMasters/ presentation package part.
</td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-notes-masters-rels-dir"><b>
           ppt:uri-ppt-notes-masters-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/notesMasters/_rels/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-presentation"><b>
           ppt:uri-ppt-presentation
           </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/presentation.xml presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-pres-props"><b>
           ppt:uri-ppt-pres-props 
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/presProps.xml presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-rels"><b>
            ppt:uri-ppt-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/_rels/presentation.xml.rels presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide"><b>
            ppt:uri-ppt-slide
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slides/slide#.xml presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-layout"><b>
            ppt:uri-ppt-slide-layout
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideLayouts/slideLayout#.xml presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-layout-rels"><b>
            ppt:uri-ppt-slide-layout-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideLayouts/_rels/slideLayout#.xml.rels presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-layout-rels-dir"><b>
            ppt:uri-ppt-slide-layout-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideLayouts/_rels/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-layouts-dir"><b>
            ppt:uri-ppt-slide-layouts-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideLayouts/ presentation package part.
          </td>
			  </tr>










<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-master"><b>
            ppt:uri-ppt-slide-master
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideMasters/slideMaster#.xml presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-master-rels"><b>
            ppt:uri-ppt-slide-master-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideMasters/_rels/slideMaster#.xml.rels presentation package part.
          </td>
			  </tr><tr class="mainbody"$src-dir as xs:string*>
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-master-rels-dir"><b>
            ppt:uri-ppt-slide-master-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideMasters/_rels/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-masters-dir"><b>
            ppt:uri-ppt-slide-masters-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slideMasters/ presentation package part.
          </td>
			  </tr>
<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-rels"><b>
            ppt:uri-ppt-slide-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slides/_rels/slide#.xml.rels presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slide-rels-dir"><b>
            ppt:uri-ppt-slide-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slides/_rels/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-slides-dir"><b>
            ppt:uri-ppt-slides-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/slides/ presentation package part.
          </td>
			  </tr>

<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-table-styles"><b>
            ppt:uri-ppt-table-styles
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/tableStyles.xml presentation package part.
          </td>
			  </tr>
<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-theme"><b>
            ppt:uri-ppt-theme
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/theme/theme#.xml presentation package part.
          </td>
			  </tr<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-theme-dir"><b>
            ppt:uri-ppt-theme-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/theme/ presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-theme-rels"><b>
            ppt:uri-ppt-theme-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/theme/_rels/theme#.xml.rels presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-theme-rels-dir"><b>
            ppt:uri-ppt-theme-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/theme/_rels/ presentation package part.
          </td>
			  </tr>
<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-ppt-view-props"><b>
            ppt:uri-ppt-view-props
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for ppt/viewProps.xml presentation package part.
          </td>
			  </tr><tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-rels"><b>
            ppt:uri-rels
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for  _rels/.rels presentation package part.
          </td>
			  </tr>
<tr class="mainbody">
			    <td style="font-family: arial; font-size: 10pt;">
          <a href="#ppt:uri-rels-dir"><b>
            ppt:uri-rels-dir
            </b></a> 
          </td>
			    <td style="font-family: arial; font-size: 10pt;">
          This function returns URI for _rels/ presentation package part.
          </td>
			  </tr>-->
                                </tbody>
                              </table>
                             </td>
			    </tr>
                            <tr>
		             <td><img src="images/varspace.gif" height="10"></td>
		            </tr>
                            <tr>
		             <td>
                              <table class="table-line" width="100%" align="right" bgcolor="#000000" cellpadding="4" cellspacing="1">
                               <tbody>
                                 <tr bgcolor="#f2ebce">
			          <td colspan="10">
                                    <font size="+1"><b>Function Detail</b></font>
                                  </td>
			         </tr>
                                 <tr class="mainbody">
				  <td>
 <table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">
				   <tbody>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12">
				      <!--<hr class="control-line" size="1">-->
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td>
                                      <table>
                                       <tbody>
                                        <tr>
					 <td colspan="2" style="font-size: 12pt; font-family: Courier;">
                                          <a id="ppt:directory-uris"></a><b><font color="#c00831">ppt:directory-uris</font></b>(
                                         </td>
				        </tr>
                                        <tr>
					 <td width="20"></td>
					 <td style="font-size: 11pt; font-family: Courier;">$directory as xs:string
                                         </td>
				        </tr>
                                        <tr>
					 <td width="20"></td>
					 <td style="font-size: 11pt; font-family: Courier;">[$depth as xs:string]
                                         </td>
				        </tr>
                                        <tr>
					 <td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp;as&nbsp;xs:string*</td>
				        </tr>
                                       </tbody>
                                      </table>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12"></td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Summary:</b>
                                      <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
                                         This function returns URIs for the presentation documents within the specified directory.
                                      </div><br>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Parameters:</b>
                                      <table>
                                       <tbody>
                                        <tr class="mainbody">
					 <td style="font-size: 11pt; font-family: Arial;">
                                          <img src="images/varspace.gif" width="8">
                                          <div style="margin-left: 0.5in; margin-right: 8px;">
                                           <font style="font-size: 11pt; font-family: Courier;">$directory:
                                           </font>
                                           <font style="font-family: arial; font-size: 10pt;">
                The directory in MarkLogic that includes the document parts for an extracted presentation. 
                                           </font>
                                          </div> 
                                         </td>
				        </tr>
                                        <tr class="mainbody">
					 <td style="font-size: 11pt; font-family: Arial;">
                                          <img src="images/varspace.gif" width="8">
                                          <div style="margin-left: 0.5in; margin-right: 8px;">
                                          <font style="font-size: 11pt; font-family: Courier;">$depth
                                          </font>
                                          <font style="font-family: arial; font-size: 10pt;">
                (optional):  The depth of the directory query. Default is "infinity". 
                                          </font>
                                         </div> 
                                        </td>
				       </tr>
                                      </tbody>
                                     </table>
                                     <br>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td>
                                     <img src="images/varspace.gif" width="8">
                                     <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
                                     <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
                                      <pre xml:space="preserve">
xquery version "1.0-ml";
import module namespace ppt=  "http://marklogic.com/openxml/powerpoint" at "/MarkLogic/openxml/presentation-ml-support.xqy";

let $presentation-dir:="/foo_pptx_parts/"   
return ppt:directory-uris($presentation-dir)

=&gt;
/foo_pptx_parts/[Content_Types].xml
/foo_pptx_parts/_rels/.rels
/foo_pptx_parts/docProps/app.xml
/foo_pptx_parts/docProps/core.xml
/foo_pptx_parts/docProps/thumbnail.jpeg
/foo_pptx_parts/ppt/_rels/presentation.xml.rels
/foo_pptx_parts/ppt/media/image1.png
/foo_pptx_parts/ppt/presProps.xml
/foo_pptx_parts/ppt/presentation.xml
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout1.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout10.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout11.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout2.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout3.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout4.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout5.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout6.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout7.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout8.xml.rels
/foo_pptx_parts/ppt/slideLayouts/_rels/slideLayout9.xml.rels
/foo_pptx_parts/ppt/slideLayouts/slideLayout1.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout10.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout11.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout2.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout3.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout4.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout5.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout6.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout7.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout8.xml
/foo_pptx_parts/ppt/slideLayouts/slideLayout9.xml
/foo_pptx_parts/ppt/slideMasters/_rels/slideMaster1.xml.rels
/foo_pptx_parts/ppt/slideMasters/slideMaster1.xml
/foo_pptx_parts/ppt/slides/_rels/slide1.xml.rels
/foo_pptx_parts/ppt/slides/slide1.xml
/foo_pptx_parts/ppt/tableStyles.xml
/foo_pptx_parts/ppt/theme/theme1.xml
/foo_pptx_parts/ppt/viewProps.xml


       
                                      </pre>
                                     </div>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td></td>
				   </tr>
	                          </tbody>
				 </table>


                                   <table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">
                                    <tbody>
                                     <tr class="mainbody">
				      <td>
					<img src="images/varspace.gif" height="12">
                                        <hr class="control-line" size="1">
                                      </td>
				     </tr>
                                     <tr class="mainbody">
				      <td>
                                       <table>
	                                <tbody>
                                         <tr>
					  <td colspan="2" style="font-size: 12pt; font-family: Courier;">
                                           <a id="ppt:insert-slide"></a><b><font color="#c00831">ppt:insert-slide</font></b>(
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$map as map:map
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$from-pres as xs:string+
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$from-idx as xs:integer+
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$insert-idx as xs:integer
                                          </td>
				         </tr>
                                         <tr>
					  <td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp;as&nbsp;map:map</td>
				         </tr>
                                        </tbody>
                                       </table>
                                      </td>
				     </tr>
                                     <tr class="mainbody">
				      <td><img src="images/varspace.gif" height="12"></td>
				     </tr>
                                     <tr class="mainbody">
				      <td style="font-size: 10pt; font-family: Arial;">
                                        <img src="images/varspace.gif" width="8">
                                        <b>Summary:</b>
                                        <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
					  This function returns updated map for the presentation, with slides inserted from 
                                          presentations specified in parameters.
					<br/><br/>

  The keys for the map are the names for the files within a presentation .pptx package.  The value for the key is either<br/>
 A) a URI for a presentation part in MarkLogic, or B) the actual XML element for the respective presentation package part.
                                        <br/><br/>
<i>Note: the lengths of the sequences of $from-pres and $from-idx must be equal, otherwise an Error is thrown. </i><br/><br/>
<i>Note: a slide may be inserted into the presentation contained within $map at any slide index that is <br/>
within the count of slides contained within the presentation +1.  Trying to insert a slide into an index that is not allowed results in Error.</i>
                                        </div><br>
                                       </td>
				      </tr>
                                      <tr class="mainbody">
				       <td style="font-size: 10pt; font-family: Arial;">
                                        <img src="images/varspace.gif" width="8">
                                        <b>Parameters:</b>
                                        <table>
                                         <tbody>
                                          <tr class="mainbody">
		                           <td style="font-size: 11pt; font-family: Arial;">
                                            <img src="images/varspace.gif" width="8">
                                            <div style="margin-left: 0.5in; margin-right: 8px;">
                                             <font style="font-size: 11pt; font-family: Courier;">
                                              $map:
                                             </font>
                                             <font style="font-family: arial; font-size: 10pt;">
                                              The map for a .pptx presentation.
                                             </font>
                                            </div> 
                                           </td>
				          </tr>
                                          <tr class="mainbody">
		                           <td style="font-size: 11pt; font-family: Arial;">
                                            <img src="images/varspace.gif" width="8">
                                            <div style="margin-left: 0.5in; margin-right: 8px;">
                                             <font style="font-size: 11pt; font-family: Courier;">
                                              $from-pres:
                                             </font>
                                             <font style="font-family: arial; font-size: 10pt;">
                The directory in MarkLogic for a presentation from which slides will be inserted into the presentation within $map.
                                             </font>
                                            </div> 
                                           </td>
				          </tr>
                                         <tr class="mainbody">
		                          <td style="font-size: 11pt; font-family: Arial;">
                                           <img src="images/varspace.gif" width="8">
                                           <div style="margin-left: 0.5in; margin-right: 8px;">
                                            <font style="font-size: 11pt; font-family: Courier;">
                                             $from-idx:
                                            </font>
                                            <font style="font-family: arial; font-size: 10pt;">
                 The index of the slide within the $from-pres that is to be inserted into $map.
                                            </font>
                                           </div> 
                                          </td>
				         </tr>
                                         <tr class="mainbody">
		                          <td style="font-size: 11pt; font-family: Arial;">
                                           <img src="images/varspace.gif" width="8">
                                           <div style="margin-left: 0.5in; margin-right: 8px;">
                                           <font style="font-size: 11pt; font-family: Courier;">
                                            $insert-idx:
                                           </font>
                                           <font style="font-family: arial; font-size: 10pt;">
                The insertion point for the presentation within $map, where the slide inserted from $from-pres will be inserted at.
                                           </font>
                                          </div> 
                                         </td>
				        </tr>
                                       </tbody>
                                      </table><br>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td>
                                      <img src="images/varspace.gif" width="8">
                                      <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
                                      <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
	                               <pre xml:space="preserve">
xquery version "1.0-ml";
import module namespace ppt=  "http://marklogic.com/openxml/powerpoint" at "/MarkLogic/openxml/presentation-ml-support.xqy";

let $targ-pres:="/one_pptx_parts/"          (:target presentation:)
let $source-pres-one:= "/two_pptx_parts/"   (:source presentation:)
let $source-pres-two:= "/three_pptx_parts/" (:another source presentation:) 
let $s-idx-1 := 1                           (: index of slide in source-pres-one to copy to target   :)
let $s-idx-2 := 15                          (: index of slide in source-pres-two to copy to target   :)
let $start-idx := 2                         (: insertion index starting point of target presentation :)

let $pptx-map := ppt:package-map-create($targ-pres)

return ppt:insert-slide($pptx-map, ($source-pres-one,$source-pres-two), ($s-idx-1,$s-idx-2), $start-idx)

=&gt;

Returns a map containing the presentation contained within /one_pptx_parts/,
updated to include slide 1 from /two_pptx_parts/ and slide 15 from /three_pptx_parts/ as slides 2 and 3 respectively.

Assuming the presentation within /one_pptx_parts/ started with 3 slides, it now has 5 total, 
and its original slides 2 and 3 have been shifted to 4 and 5 respectively.

For each slide mapped within the map, images will be retained and references throughout the package will be updated. 
Slides will use the master and layout of the presentation within the map.  Slides inserted will retain the target presentation look and feel. 
<br/><br/>
Add notes here about what this function does/doesn't do. 

 
                                       </pre>
                                      </div>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td></td>
				    </tr>
                                   </tbody>
                                  </table>
                                  <table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">
				   <tbody>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12">
                                      <hr class="control-line" size="1">
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td>
                                      <table>
                                       <tbody>
                                        <tr>
					 <td colspan="2" style="font-size: 12pt; font-family: Courier;">
                                          <a id="ppt:package-make"></a><b><font color="#c00831">ppt:package-make</font></b>(
                                         </td>
				        </tr>
                                        <tr>
					 <td width="20"></td>
					 <td style="font-size: 11pt; font-family: Courier;">$directory as xs:string
                                         </td>
				        </tr>
                                        <tr>
					 <td width="20"></td>
					 <td style="font-size: 11pt; font-family: Courier;">$uris as xs:string*
                                         </td>
				        </tr>
                                        <tr>
					 <td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp;as&nbsp;element(pkg:package)</td>
				        </tr>
                                       </tbody>
                                      </table>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12"></td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Summary:</b>
                                      <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function returns a presentation in the OPC (Open Packaging Convention) format XML.
                                      </div><br>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Parameters:</b>
                                      <table>
                                       <tbody>
                                        <tr class="mainbody">
					 <td style="font-size: 11pt; font-family: Arial;">
                                          <img src="images/varspace.gif" width="8">
                                          <div style="margin-left: 0.5in; margin-right: 8px;">
                                           <font style="font-size: 11pt; font-family: Courier;">$directory:
                                           </font>
                                           <font style="font-family: arial; font-size: 10pt;">
                The directory in MarkLogic that includes the files for an extracted presentation. 
                                           </font>
                                          </div> 
                                         </td>
				        </tr>
                                        <tr class="mainbody">
					 <td style="font-size: 11pt; font-family: Arial;">
                                          <img src="images/varspace.gif" width="8">
                                          <div style="margin-left: 0.5in; margin-right: 8px;">
                                          <font style="font-size: 11pt; font-family: Courier;">$uris:
                                          </font>
                                          <font style="font-family: arial; font-size: 10pt;">
                The uris for the files within the $directory to use to as the pkg:parts of the OPC package. 
                                          </font>
                                         </div> 
                                        </td>
				       </tr>
                                      </tbody>
                                     </table>
                                     <br>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td>
                                     <img src="images/varspace.gif" width="8">
                                     <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
                                     <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
				      <pre xml:space="preserve">
xquery version "1.0-ml";
import module namespace ppt=  "http://marklogic.com/openxml/powerpoint" at "/MarkLogic/openxml/presentation-ml-support.xqy";

let $presentation-dir:="/foo_pptx_parts/" 
let $uris := ppt:directory-uris($presentation-dir) 
return ppt:package-make($presentation-dir, $uris)
=&gt;
&lt;pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage"&gt;
  &lt;pkg:part pkg:name="/_rels/.rels" pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:padding="512"&gt;
    &lt;pkg:xmlData&gt;
      &lt;Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"&gt;
        &lt;Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/&gt;
        &lt;Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail" Target="docProps/thumbnail.jpeg"/&gt;
        &lt;Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="ppt/presentation.xml"/&gt;
        &lt;Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/&gt;
      &lt;/Relationships&gt;
    &lt;/pkg:xmlData&gt;
  &lt;/pkg:part&gt;
  &lt;pkg:part pkg:name="/docProps/app.xml" pkg:contentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"&gt;
    &lt;pkg:xmlData&gt;
      &lt;Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" 
                     xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"&gt;
        &lt;TotalTime&gt;0&lt;/TotalTime&gt;
        &lt;Words&gt;4&lt;/Words&gt;
        &lt;Application&gt;Microsoft Office PowerPoint&lt;/Application&gt;
        &lt;PresentationFormat&gt;On-screen Show (4:3)&lt;/PresentationFormat&gt;
        &lt;Paragraphs&gt;1&lt;/Paragraphs&gt;
        &lt;Slides&gt;1&lt;/Slides&gt;
        &lt;Notes&gt;0&lt;/Notes&gt;
        &lt;HiddenSlides&gt;0&lt;/HiddenSlides&gt;
        &lt;MMClips&gt;0&lt;/MMClips&gt;
        &lt;ScaleCrop&gt;false&lt;/ScaleCrop&gt;
        &lt;HeadingPairs&gt;
          &lt;vt:vector size="4" baseType="variant"&gt;
            &lt;vt:variant&gt;
              &lt;vt:lpstr&gt;Theme&lt;/vt:lpstr&gt;
            &lt;/vt:variant&gt;
            &lt;vt:variant&gt;
              &lt;vt:i4&gt;1&lt;/vt:i4&gt;
            &lt;/vt:variant&gt;
            &lt;vt:variant&gt;
              &lt;vt:lpstr&gt;Slide Titles&lt;/vt:lpstr&gt;
            &lt;/vt:variant&gt;
            &lt;vt:variant&gt;
              &lt;vt:i4&gt;1&lt;/vt:i4&gt;
            &lt;/vt:variant&gt;
          &lt;/vt:vector&gt;
        &lt;/HeadingPairs&gt;
        &lt;TitlesOfParts&gt;
          &lt;vt:vector size="2" baseType="lpstr"&gt;
            &lt;vt:lpstr&gt;Office Theme&lt;/vt:lpstr&gt;
            &lt;vt:lpstr&gt;Slide 1&lt;/vt:lpstr&gt;
          &lt;/vt:vector&gt;
        &lt;/TitlesOfParts&gt;
        &lt;Company&gt;Mark Logic Corporation&lt;/Company&gt;
        &lt;LinksUpToDate&gt;false&lt;/LinksUpToDate&gt;
        &lt;SharedDoc&gt;false&lt;/SharedDoc&gt;
        &lt;HyperlinksChanged&gt;false&lt;/HyperlinksChanged&gt;
        &lt;AppVersion&gt;12.0000&lt;/AppVersion&gt;
      &lt;/Properties&gt;
    &lt;/pkg:xmlData&gt;
  &lt;/pkg:part&gt;
  &lt;pkg:part pkg:name="/docProps/core.xml" pkg:contentType="application/vnd.openxmlformats-package.core-properties+xml"&gt;
    &lt;pkg:xmlData&gt;
      &lt;cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" 
			    xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/"             
                            xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
        &lt;dc:title&gt;Slide 1&lt;/dc:title&gt;
        &lt;dc:creator&gt;paven&lt;/dc:creator&gt;
        &lt;cp:lastModifiedBy&gt;paven&lt;/cp:lastModifiedBy&gt;
        &lt;cp:revision&gt;1&lt;/cp:revision&gt;
        &lt;dcterms:created xsi:type="dcterms:W3CDTF"&gt;2009-09-01T19:36:41Z&lt;/dcterms:created&gt;
        &lt;dcterms:modified xsi:type="dcterms:W3CDTF"&gt;2009-09-01T19:37:25Z&lt;/dcterms:modified&gt;
      &lt;/cp:coreProperties&gt;
    &lt;/pkg:xmlData&gt;
  &lt;/pkg:part&gt;
  &lt;pkg:part pkg:name="/docProps/thumbnail.jpeg" pkg:contentType="image/jpeg" pkg:compression="store"&gt;
    &lt;pkg:binaryData&gt;
      /9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEB
      AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEB
      ...
      ... 
      ...
  &lt;/pkg:part&gt;
&lt;/pkg:package&gt;
				      </pre>
<font style="font-family: arial; font-size: 10pt;"><i>
Note: example above truncated for brevity.  All pieces of .pptx package are present and serialized within &lt;pkg:package&gt;, captured as &lt;pkg:part&gt; elements.<br/>
Images in this model are captured as base64 encoded strings, following the Open XML format.  This file may be opened as <br/>
a .XML file within PowerPoint.  Saving as XML in PowerPoint will generate this format for a .pptx package as well.<br/>
</font></i>
                                     </div>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td></td>
				   </tr>
	                          </tbody>
				 </table>


 <table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">
				   <tbody>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12">
                                      <hr class="control-line" size="1">
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td>
                                      <table>
                                       <tbody>
                                        <tr>
					 <td colspan="2" style="font-size: 12pt; font-family: Courier;">
                                          <a id="ppt:package-map"></a><b><font color="#c00831">ppt:package-map</font></b>(
                                         </td>
				        </tr>
                                        <tr>
					 <td width="20"></td>
					 <td style="font-size: 11pt; font-family: Courier;">$directory as xs:string
                                         </td>
				        </tr>
                                        <tr>
					 <td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp;as&nbsp;map:map</td>
				        </tr>
                                       </tbody>
                                      </table>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12"></td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Summary:</b>
                                      <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function returns a map for the specified presentation. Map keys are equivalent to the manifest for the .pptx zip package.  Map values are URIs for the package parts located in MarkLogic.
                                      </div><br>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Parameters:</b>
                                      <table>
                                       <tbody>
                                        <tr class="mainbody">
					 <td style="font-size: 11pt; font-family: Arial;">
                                          <img src="images/varspace.gif" width="8">
                                          <div style="margin-left: 0.5in; margin-right: 8px;">
                                           <font style="font-size: 11pt; font-family: Courier;">$directory:
                                           </font>
                                           <font style="font-family: arial; font-size: 10pt;">
                The directory in MarkLogic that contains the files of extracted presentation to be used for map. 
                                           </font>
                                          </div> 
                                         </td>
				        </tr>
                                      </tbody>
                                     </table>
                                     <br>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td>
                                     <img src="images/varspace.gif" width="8">
                                     <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
                                     <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
                                      <pre xml:space="preserve">
xquery version "1.0-ml";
import module namespace ppt=  "http://marklogic.com/openxml/powerpoint" at "/MarkLogic/openxml/presentation-ml-support.xqy";

let $presentation-dir:="/foo_pptx_parts/" 
let $map := ppt:package-map($presentation-dir)
return map:keys($map)
=&gt;
ppt/slideLayouts/slideLayout10.xml
ppt/slideLayouts/slideLayout11.xml
ppt/slideLayouts/slideLayout3.xml
ppt/slideLayouts/slideLayout4.xml
ppt/slideLayouts/slideLayout8.xml
ppt/slideLayouts/_rels/slideLayout4.xml.rels
ppt/media/image1.png
ppt/slideLayouts/_rels/slideLayout1.xml.rels
ppt/presProps.xml
ppt/slideMasters/slideMaster1.xml
docProps/thumbnail.jpeg
ppt/slides/slide1.xml
ppt/slideLayouts/_rels/slideLayout8.xml.rels
ppt/slideLayouts/_rels/slideLayout5.xml.rels
ppt/slideLayouts/_rels/slideLayout11.xml.rels
ppt/slides/_rels/slide1.xml.rels
ppt/presentation.xml
ppt/tableStyles.xml
ppt/viewProps.xml
ppt/slideLayouts/slideLayout1.xml
docProps/app.xml
ppt/slideLayouts/slideLayout5.xml
ppt/slideLayouts/slideLayout9.xml
[Content_Types].xml
docProps/core.xml
ppt/slideLayouts/_rels/slideLayout2.xml.rels
ppt/slideLayouts/_rels/slideLayout9.xml.rels
ppt/slideLayouts/_rels/slideLayout6.xml.rels
ppt/slideLayouts/_rels/slideLayout3.xml.rels
ppt/slideLayouts/slideLayout2.xml
ppt/_rels/presentation.xml.rels
ppt/slideLayouts/slideLayout6.xml
ppt/theme/theme1.xml
ppt/slideLayouts/slideLayout7.xml
_rels/.rels
ppt/slideLayouts/_rels/slideLayout7.xml.rels
ppt/slideLayouts/_rels/slideLayout10.xml.rels
ppt/slideMasters/_rels/slideMaster1.xml.rels
                                      </pre>
                                     </div>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td></td>
				   </tr>
	                          </tbody>
				 </table>


 <table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">
				   <tbody>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12">
                                      <hr class="control-line" size="1">
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td>
                                      <table>
                                       <tbody>
                                        <tr>
					 <td colspan="2" style="font-size: 12pt; font-family: Courier;">
                                          <a id="ppt:package-map-zip"></a><b><font color="#c00831">ppt:package-map-zip</font></b>(
                                         </td>
				        </tr>
                                        <tr>
					 <td width="20"></td>
					 <td style="font-size: 11pt; font-family: Courier;">$map as map:map
                                         </td>
				        </tr>
                                        <tr>
					 <td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp;as&nbsp;binary()</td>
				        </tr>
                                       </tbody>
                                      </table>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td><img src="images/varspace.gif" height="12"></td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Summary:</b>
                                      <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function returns the zip archive for the documents specified in the map.  
                                      </div><br>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td style="font-size: 10pt; font-family: Arial;">
                                      <img src="images/varspace.gif" width="8">
                                      <b>Parameters:</b>
                                      <table>
                                       <tbody>
                                        <tr class="mainbody">
					 <td style="font-size: 11pt; font-family: Arial;">
                                          <img src="images/varspace.gif" width="8">
                                          <div style="margin-left: 0.5in; margin-right: 8px;">
                                           <font style="font-size: 11pt; font-family: Courier;">$map:
                                           </font>
                                           <font style="font-family: arial; font-size: 10pt;">
		The map to create a zip archive from. The map keys will be used for as the manifest values. 
                <br/>The map values are either URIs for documents on the server, or the XML that should be used for the file specified by key.  
                                           </font>
                                          </div> 
                                         </td>
				        </tr>
                                      </tbody>
                                     </table>
                                     <br>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td>
                                     <img src="images/varspace.gif" width="8">
                                     <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
                                     <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
                                      <pre xml:space="preserve">
xquery version "1.0-ml";
import module namespace ppt=  "http://marklogic.com/openxml/powerpoint" at "/MarkLogic/openxml/presentation-ml-support.xqy";


let $presentation-dir:="/foo_pptx_parts/" 
let $map := ppt:package-map($presentation-dir)
let $zip := ppt:package-map-zip($map)
return xdmp:save("C:\foo2.pptx",$zip)
=&gt;
foo2.pptx is saved on the filesystem.  this can be opened in PowerPoint.
       
                                      </pre>
                                     </div>
                                    </td>
				   </tr>
                                   <tr class="mainbody">
				    <td></td>
				   </tr>
	                          </tbody>
				 </table>
<!--
        <table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:package-map-create"></a><b><font color="#c00831">
                 excel:a1-to-r1c1</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                       $a1notation as xs:string 
                      </td>
				      </tr>
				      <tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function converts the cell coordinate in A1 notation to  R1C1 notation (row/column notation). <br/>Excel's limits for rows is 1048756, and for columns is 16384.
This function returns R1C1 notation for any cell in that range <br/>from A1 to
WID1048576. </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $a1notation
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 the A1 style coordinate reference.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table>
         <br>
    </td>
				</tr>
 
        
<table>
	                                <tbody>
                                         <tr>
					  <td colspan="2" style="font-size: 12pt; font-family: Courier;">
                                           <a id="ppt:insert-slide"></a><b><font color="#c00831">ppt:insert-slide</font></b>(
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$map as map:map
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$from-pres as xs:string+
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$from-idx as xs:integer+
                                          </td>
				         </tr>
                                         <tr>
					  <td width="20"></td>
					  <td style="font-size: 11pt; font-family: Courier;">$insert-idx as xs:integer
                                          </td>
				         </tr>
                                         <tr>
					  <td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp;as&nbsp;map:map</td>
				         </tr>
                                        </tbody>
                                       </table>
                                      </td>
				     </tr>
                                     <tr class="mainbody">
				      <td><img src="images/varspace.gif" height="12"></td>
				     </tr>
                                     <tr class="mainbody">
				      <td style="font-size: 10pt; font-family: Arial;">
                                        <img src="images/varspace.gif" width="8">
                                        <b>Summary:</b>
                                        <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
					  This function returns updated map for the presentation, with slides inserted from 
                                          presentations specified in parameters.
					<br/><br/>

  The keys for the map are the names for the files within a presentation .pptx package.  The value for the key is either<br/>
 A) a URI for a presentation part in MarkLogic, or B) the actual XML element for the respective presentation package part.
                                        <br/><br/>
<i>Note: the lengths of the sequences of $from-pres and $from-idx must be equal, otherwise an Error is thrown. </i><br/><br/>
<i>Note: a slide may be inserted into the presentation contained within $map at any slide index that is <br/>
within the count of slides contained within the presentation +1.  Trying to insert a slide into an index that is not allowed results in Error.</i>
                                        </div><br>
                                       </td>
				      </tr>
                                      <tr class="mainbody">
				       <td style="font-size: 10pt; font-family: Arial;">
                                        <img src="images/varspace.gif" width="8">
                                        <b>Parameters:</b>
                                        <table>
                                         <tbody>
                                          <tr class="mainbody">
		                           <td style="font-size: 11pt; font-family: Arial;">
                                            <img src="images/varspace.gif" width="8">
                                            <div style="margin-left: 0.5in; margin-right: 8px;">
                                             <font style="font-size: 11pt; font-family: Courier;">
                                              $map:
                                             </font>
                                             <font style="font-family: arial; font-size: 10pt;">
                                              The map for a .pptx presentation.
                                             </font>
                                            </div> 
                                           </td>
				          </tr>
                                          <tr class="mainbody">
		                           <td style="font-size: 11pt; font-family: Arial;">
                                            <img src="images/varspace.gif" width="8">
                                            <div style="margin-left: 0.5in; margin-right: 8px;">
                                             <font style="font-size: 11pt; font-family: Courier;">
                                              $from-pres:
                                             </font>
                                             <font style="font-family: arial; font-size: 10pt;">
                The directory in MarkLogic for a presentation from which slides will be inserted into the presentation within $map.
                                             </font>
                                            </div> 
                                           </td>
				          </tr>
                                         <tr class="mainbody">
		                          <td style="font-size: 11pt; font-family: Arial;">
                                           <img src="images/varspace.gif" width="8">
                                           <div style="margin-left: 0.5in; margin-right: 8px;">
                                            <font style="font-size: 11pt; font-family: Courier;">
                                             $from-idx:
                                            </font>
                                            <font style="font-family: arial; font-size: 10pt;">
                 The index of the slide within the $from-pres that is to be inserted into $map.
                                            </font>
                                           </div> 
                                          </td>
				         </tr>
                                         <tr class="mainbody">
		                          <td style="font-size: 11pt; font-family: Arial;">
                                           <img src="images/varspace.gif" width="8">
                                           <div style="margin-left: 0.5in; margin-right: 8px;">
                                           <font style="font-size: 11pt; font-family: Courier;">
                                            $insert-idx:
                                           </font>
                                           <font style="font-family: arial; font-size: 10pt;">
                The insertion point for the presentation within $map, where the slide inserted from $from-pres will be inserted at.
                                           </font>
                                          </div> 
                                         </td>
				        </tr>
                                       </tbody>
                                      </table><br>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td>
                                      <img src="images/varspace.gif" width="8">
                                      <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
                                      <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
	                               <pre xml:space="preserve">
xquery version "1.0-ml";
import module namespace ppt=  "http://marklogic.com/openxml/powerpoint" at "/MarkLogic/openxml/presentation-ml-support.xqy";

let $targ-pres:="/one_pptx_parts/"          (:target presentation:)
let $source-pres-one:= "/two_pptx_parts/"   (:source presentation:)
let $source-pres-two:= "/three_pptx_parts/" (:another source presentation:) 
let $s-idx-1 := 1                           (: index of slide in source-pres-one to copy to target   :)
let $s-idx-2 := 15                          (: index of slide in source-pres-two to copy to target   :)
let $start-idx := 2                         (: insertion index starting point of target presentation :)

let $pptx-map := ppt:package-map-create($targ-pres)

return ppt:insert-slide($pptx-map, ($source-pres-one,$source-pres-two), ($s-idx-1,$s-idx-2), $start-idx)

=&gt;

Returns a map containing the presentation contained within /one_pptx_parts/,
updated to include slide 1 from /two_pptx_parts/ and slide 15 from /three_pptx_parts/ as slides 2 and 3 respectively.

Assuming the presentation within /one_pptx_parts/ started with 3 slides, it now has 5 total, 
and its original slides 2 and 3 have been shifted to 4 and 5 respectively.

For each slide mapped within the map, images will be retained and references throughout the package will be updated. 
Slides will use the master and layout of the presentation within the map.  Slides inserted will retain the target presentation look and feel. 
<br/><br/>
Add notes here about what this function does/doesn't do. 

 
                                       </pre>
                                      </div>
                                     </td>
				    </tr>
                                    <tr class="mainbody">
				     <td></td>
				    </tr>
                                   </tbody>
                                  </table>
        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:a1-to-r1c1("CJL1")
=&gt;
R:1C:2378 
 </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table>















<table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:package-map-zip"></a><b><font color="#c00831">
                 excel:cell</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $a1-ref as xs:string, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $value as xs:anyAtomicType?, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$formula as xs:string?], 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$date-id as xs:integer?]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:c)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a cell.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $a1-ref
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The row and column number for the cell provided in A1 notation.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $value
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The cell value, either a number or a string.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $formula
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The formula for the cell.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $date-id
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The date style for the cell.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:cell("A1",123) 
=&gt;
&lt;ms:c r="A1" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:v&gt;123&lt;/ms:v&gt;
&lt;/ms:c&gt;


  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:cell("A3",(),"SUM(A1:A2)")
=&gt;
&lt;ms:c r="A3" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:f&gt;SUM(A1:A2)&lt;/ms:f&gt;
&lt;/ms:c&gt;

Note: 
Above we pass the empty sequence for the value, so only the formula is populated for the cell. 
This way, when the cell is opened within Excel, the value will be generated by the formula and
populated within the cell.  It is possible to create a cell with a value and a formula, where
the value the formula calculates and the value are not equal.  Excel will not automatically correct this disparity
upon consuming the cell.

  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:cell("A3",32999,(),0)
=&gt;
&lt;ms:c r="A3" s="0" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:v&gt;32999&lt;/ms:v&gt;
&lt;/ms:c&gt;

Note:
Formula and date style assignment only applies to cells containing numeric values. 
Formula and date style assignment will be ignored in the case that $value is of type xs:string.


  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:package-uris-from-directory"></a><b><font color="#c00831">
                 excel:cell-string-value</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $cells as element(ms:c)*, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $shared-strings as element(ms:sst)
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string*</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function returns the text values for the cells, mapping their
values from the sharedStrings table. Cell values that are numbers will
be returned as text. </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $cells
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The cells from the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $shared-strings
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The sharedStrings table.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
declare namespace ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main";

let $dir := "/Default_xlsx_parts/"
let $ss := fn:doc(excel:sharedstring-uri($dir))/node()
let $cels := (&lt;ms:c&gt;
                &lt;ms:v&gt;1&lt;/ms:v&gt;
              &lt;/ms:c&gt;,
              &lt;ms:c t="s"&gt;
                &lt;ms:v&gt;1&lt;/ms:v&gt;
              &lt;/ms:c&gt;)
return excel:cell-string-value ($cels,$ss)

1
TEST
 </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:package-files-only"></a><b><font color="#c00831">
                 excel:column-width</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $widths as xs:integer+
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:cols)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates the ms:cols element, which can be added to a worksheet to define custom column widths. 
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $widths
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
A sequence of column widths. It is assumed that the column widths are
set by the order of the items in the sequence. </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:column-width((15,15,15))
=&gt;
&lt;ms:cols xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:col min="1" max="1" width="15" customWidth="1"/&gt;
   &lt;ms:col min="2" max="2" width="15" customWidth="1"/&gt;
   &lt;ms:col min="3" max="3" width="15" customWidth="1"/&gt;
&lt;/ms:cols&gt;


  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-app-props"></a><b><font color="#c00831">
                 excel:content-types</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $worksheet-count as xs:integer, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$tbl-count as xs:integer]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(types:Types)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a content types element for the .xlsx package ([Content_Types].xml)
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $worksheet-count
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number of worksheets in the .xlsx package.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $tbl-count
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number ot tablles in the .xlsx package
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">		    
xquery version "1.0-ml"; 
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:content-types(3) 
=&gt;
&lt;Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"&gt;
   &lt;Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/&gt;
   &lt;Default Extension="xml" ContentType="application/xml"/&gt;
   &lt;Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/&gt;
   &lt;Override PartName="/xl/worksheets/sheet1" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/&gt;
   &lt;Override PartName="/xl/worksheets/sheet2" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/&gt;
   &lt;Override PartName="/xl/worksheets/sheet3" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/&gt;
&lt;/Types&gt;

 </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">		    
xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:content-types(1,1)
=&gt;
&lt;Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"&gt;
   &lt;Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/&gt;
   &lt;Default Extension="xml" ContentType="application/xml"/&gt;
   &lt;Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/&gt;
   &lt;Override PartName="/xl/worksheets/sheet1" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/&gt;
   &lt;Override PartName="/xl/tables/table1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"/&gt;
&lt;/Types&gt;
      
 </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-content-types"></a><b><font color="#c00831">
                 excel:create-row</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $values as xs:anyAtomicType*
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:row)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function creates a row populated with cells, the values of which are passed in with the parameter sequence. The cell's values
are either a number type or of type string. <br/>This function creates a simple row, containing simple cells;
there is no way to set row number explicitly, and there is no way to
set cell row/column position. It is assumed that the cells <br/>are
populated in the row in the order that they are passed to the function.
</div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $values
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 number or string values that will be used as values for cells populated within row.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml"; 
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
let $vals :=(1,2,3,"TEST")
return excel:create-row($vals)
=&gt;
&lt;ms:row xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:c&gt;&lt;ms:v&gt;1&lt;/ms:v&gt;&lt;/ms:c&gt;
   &lt;ms:c&gt;&lt;ms:v&gt;2&lt;/ms:v&gt;&lt;/ms:c&gt;
   &lt;ms:c&gt;&lt;ms:v&gt;3&lt;/ms:v&gt;&lt;/ms:c&gt;
   &lt;ms:c t="inlineStr"&gt;&lt;ms:is&gt;&lt;ms:t&gt;TEST&lt;/ms:t&gt;&lt;/ms:is&gt;&lt;/ms:c&gt;
&lt;/ms:row&gt;


       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-core-props"></a><b><font color="#c00831">
                 excel:create-row</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $map as map:map, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $keys as xs:string*
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:row)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function creates a row populated with cells, the values of which are passed in with the map parameter. The cell's values
are either a number or of type string. This function creates a simple row, <br/>with simple cells; there
is no way to set row number explicitly, and there is no way to set cell
row/column position. It is assumed that the cells are populated in the
row in the order that they are passed <br/>to the function within the map.
Keys are passed separately as you may have more keys than are contained
within the map, this is done for sparsely populated tables. If the key
doesn't exist within <br/>the map, the cell will be created but will not
contain any value. </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $map
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 Map containing values to be used for cell values within row.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $keys
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 Keys to be used for column values.  If key doesn't exist within map, an empty cell will be created.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
let $map := map:map()
let $put := (map:put($map, "RequestID",45683),
             map:put($map, "Customer","Pete"))

let $keys := ("Customer","Address","RequestID")
return excel:create-row($map,$keys)
=&gt;
&lt;ms:row xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:c t="inlineStr"&gt;&lt;ms:is&gt;&lt;ms:t&gt;Pete&lt;/ms:t&gt;&lt;/ms:is&gt;&lt;/ms:c&gt;
   &lt;ms:c t="inlineStr"&gt;&lt;ms:is&gt;&lt;ms:t/&gt;&lt;/ms:is&gt;&lt;/ms:c&gt;
   &lt;ms:c&gt;&lt;ms:v&gt;45683&lt;/ms:v&gt;&lt;/ms:c&gt;
&lt;/ms:row&gt;

       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-docprops-dir"></a><b><font color="#c00831">
                 excel:create-simple-xlsx</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $worksheets as element(ms:worksheet)*
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;binary()</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function creates a .zip file that is a .xlsx package containing
the minimum parts required to be a valid package. The parts include:
[Content_Types].xml, .rels, workbook.xml, <br/>workbook.xml.rels, and the
sheets. Sheets are saved as sheet1.xml, sheet2.xml... to sheetN.xml.
Pass the sheets into the function in the order you'd like them to be
displayed in the workbook. </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $worksheets
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The worksheets to be used with the new workbook (.xlsx)
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
declare namespace ms = "http://schemas.openxmlformats.org/spreadsheetml/2006/main";

let $ws:= (&lt;ms:worksheet&gt;
                &lt;ms:sheetData&gt;
                 &lt;ms:row&gt;
                   &lt;ms:c t="s"&gt;
                   &lt;ms:v&gt;1&lt;/ms:v&gt;
                 &lt;/ms:c&gt;
                &lt;/ms:row&gt;
               &lt;/ms:sheetData&gt;
            &lt;/ms:worksheet&gt;)
return xdmp:zip-manifest(excel:create-simple-xlsx($ws))
=&gt;
&lt;parts xmlns="xdmp:zip"&gt;
  &lt;part uncompressed-size="499" compressed-size="218" encrypted="false"&gt;[Content_Types].xml&lt;/part&gt;
  &lt;part uncompressed-size="229" compressed-size="146" encrypted="false"&gt;xl/workbook.xml&lt;/part&gt;
  &lt;part uncompressed-size="241" compressed-size="140" encrypted="false"&gt;_rels/.rels&lt;/part&gt;
  &lt;part uncompressed-size="242" compressed-size="144" encrypted="false"&gt;xl/_rels/workbook.xml.rels&lt;/part&gt;
  &lt;part uncompressed-size="178" compressed-size="119" encrypted="false"&gt;xl/worksheets/sheet1.xml&lt;/part&gt;
&lt;/parts&gt;

 </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-dir"></a><b><font color="#c00831">
                 excel:create-xlsx-from-xml-table</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $original-xml as node(), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$col-cust-width as xs:integer?], 
                      </td>
				      </tr>
<tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$auto-filter as xs:boolean?]
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$tbl-style as xs:boolean?]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;binary()?</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function will attempt to generate an Excel workbook from an XML
table. An XML table here is defined as a single wrapper element, with a
single repeating child element. <br/>The children elements of this repeating
element may vary in name and number. The list of distinct names of all the children elements will be
used as headers for columns, and <br/>their values will populate rows. It is
possible for the children to have different element names, so its
possible to generate a sparsely populated table. If the xlsx <br/>is not able to be created, and empty sequence is returned.</div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $original-xml
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The XML to be converted.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $col-cust-width
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 A custom width for the columns in the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
	 </tbody></table>
<table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $auto-filter
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 If true, columns will have auto-filter enabled. 
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table>
<table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $tbl-style
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 If true, then the table will have style TableStyleMedium10 applied.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";		    
import module namespace excel= "http://marklogic.com/openxml/excel" 
at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
let $xml := &lt;catalog&gt;
              &lt;item&gt;
                 &lt;product&gt;beach ball&lt;/product&gt;
                 &lt;sku&gt;123123&lt;/sku&gt;
              &lt;/item&gt;
              &lt;item&gt;
                 &lt;product&gt;swim fins&lt;/product&gt;
                 &lt;sku&gt;444444&lt;/sku&gt;
              &lt;/item&gt;
              &lt;item&gt;
                 &lt;product&gt;scuba glasses&lt;/product&gt;
                 &lt;sku&gt;888&lt;/sku&gt;
              &lt;/item&gt;
             &lt;/catalog&gt;
let $package := excel:create-xlsx-from-xml-table($xml,"15",fn:true())
return xdmp:zip-manifest($package)
=&gt;
&lt;parts xmlns="xdmp:zip"&gt;
  &lt;part uncompressed-size="627" compressed-size="232" encrypted="false"&gt;[Content_Types].xml&lt;/part&gt;
  &lt;part uncompressed-size="229" compressed-size="146" encrypted="false"&gt;xl/workbook.xml&lt;/part&gt;
  &lt;part uncompressed-size="241" compressed-size="140" encrypted="false"&gt;_rels/.rels&lt;/part&gt;
  &lt;part uncompressed-size="242" compressed-size="144" encrypted="false"&gt;xl/_rels/workbook.xml.rels&lt;/part&gt;
  &lt;part uncompressed-size="1034" compressed-size="297" encrypted="false"&gt;xl/worksheets/sheet1.xml&lt;/part&gt;
  &lt;part uncompressed-size="237" compressed-size="141" encrypted="false"&gt;xl/worksheets/_rels/sheet1.xml.rels&lt;/part&gt;
  &lt;part uncompressed-size="410" compressed-size="229" encrypted="false"&gt;xl/tables/table1.xml&lt;/part&gt;
&lt;/parts&gt;

       
  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";		  
import module namespace excel= "http://marklogic.com/openxml/excel" 
at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";


let $xml := &lt;catalog&gt;
              &lt;item&gt;
                 &lt;product&gt;beach ball&lt;/product&gt;
                 &lt;sku&gt;123123&lt;/sku&gt;
              &lt;/item&gt;
              &lt;item&gt;
                 &lt;product&gt;swim fins&lt;/product&gt;
                 &lt;sku&gt;444444&lt;/sku&gt;
              &lt;/item&gt;
              &lt;item&gt;
                 &lt;product&gt;scuba glasses&lt;/product&gt;
                 &lt;sku&gt;888&lt;/sku&gt;
              &lt;/item&gt;
             &lt;/catalog&gt;

let $package := excel:create-xlsx-from-xml-table($xml,"15",xs:boolean("true"))
let $doc := xdmp:zip-get($package,"xl/worksheets/sheet1.xml")
return $doc
=&gt;
&lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;cols xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
      &lt;col min="1" max="1" width="15" customWidth="1"/&gt;
      &lt;col min="2" max="2" width="15" customWidth="1"/&gt;
   &lt;/cols&gt;
   &lt;sheetData&gt;
      &lt;row xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
         &lt;c t="inlineStr"&gt;&lt;is&gt;&lt;t&gt;product&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;
         &lt;c t="inlineStr"&gt;&lt;is&gt;&lt;t&gt;sku&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;
      &lt;/row&gt;
      &lt;row xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
	 &lt;c t="inlineStr"&gt;&lt;is&gt;&lt;t&gt;beach ball&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;
	 &lt;c&gt;&lt;v&gt;123123&lt;/v&gt;&lt;/c&gt;
      &lt;/row&gt;
      &lt;row xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
         &lt;c t="inlineStr"&gt;&lt;is&gt;&lt;t&gt;swim fins&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;
         &lt;c&gt;&lt;v&gt;444444&lt;/v&gt;&lt;/c&gt;
      &lt;/row&gt;
      &lt;row xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
         &lt;c t="inlineStr"&gt;&lt;is&gt;&lt;t&gt;scuba glasses&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;
	 &lt;c&gt;&lt;v&gt;888&lt;/v&gt;&lt;/c&gt;
      &lt;/row&gt;
   &lt;/sheetData&gt;
   &lt;tableParts count="1"&gt;
      &lt;tablePart r:id="rId1" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/&gt;
   &lt;/tableParts&gt;
&lt;/worksheet&gt;
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-handout-master"></a><b><font color="#c00831">
                 excel:directory-to-filename</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $directory as xs:string
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function converts the directory name, to the name of the .xlsx package.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $directory
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The directory name to be converted.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml"; 
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:directory-to-filename("/Default_xlsx_parts/")
=&gt;
Default.xlsx       
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-handout-master-rels"></a><b><font color="#c00831">
                 ppt:uri-ppt-handout-master-rels</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $directory as xs:string, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$includesheets as xs:boolean]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string*</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function returns the URIs for files extracted from .xlsx package using Open XML Extract pipeline.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $directory
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The name of the directory containing the extracted .xlsx parts.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $includesheets
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 Set whether worksheets are returned with URIs.  The Default setting is true.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";		    
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
	    
excel:directory-uris("/Default_xlsx_parts/")
=&gt;
/Default_xlsx_parts/[Content_Types].xml
/Default_xlsx_parts/_rels/.rels
/Default_xlsx_parts/customXml/_rels/item1.xml.rels
/Default_xlsx_parts/customXml/item1.xml
/Default_xlsx_parts/customXml/itemProps1.xml
/Default_xlsx_parts/docProps/app.xml
/Default_xlsx_parts/docProps/core.xml
/Default_xlsx_parts/xl/_rels/workbook.xml.rels
/Default_xlsx_parts/xl/sharedStrings.xml
/Default_xlsx_parts/xl/styles.xml
/Default_xlsx_parts/xl/theme/theme1.xml
/Default_xlsx_parts/xl/workbook.xml
/Default_xlsx_parts/xl/worksheets/sheet1.xml
/Default_xlsx_parts/xl/worksheets/sheet2.xml
/Default_xlsx_parts/xl/worksheets/sheet3.xml
   
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-handout-master-rels-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-handout-master-rels-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $uri as xs:string
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string?</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function returns the mimetype for the given URI. Wrapper for xdmp:uri-content-type().
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $uri
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 URI reference
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:get-mimetype("Default.xlsx")
=&gt; 
application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-handout-masters-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-handout-masters-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $date as xs:date 
                      </td>
				      </tr><tr>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:integer</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function converts a gregorian date to an Excel julian day
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $date
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The date.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table>
         <br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";		    
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:gregorian-to-julian(xs:date("2009-04-06"))
=&gt;
39909
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-media-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-media-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $excel-julian-day as xs:integer
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:dateTime</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function converts and Excel julian day number to a gregorian date.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $excel-julian-day
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The Excel julian day.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:julian-to-gregorian(39909)
=&gt;
2009-04-06
       

  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-notes-master"></a><b><font color="#c00831">
                 ppt:uri-ppt-notes-master</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $sheet as element(ms:worksheet), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $shared-strings as element(ms:sst)
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:worksheet)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function dereferences cell text values so the actual text value is stored within
the worksheet, instead of just a reference to the sharedStrings table. For string values in worksheet cells, <br/>Excel stores an index to the sharedStrings table (ms:sst element, sharedStrings.xml in the .xlsx package).  We dereference for search, and as people would like to get as much information <br/>in the actual worksheet as possible, instead of having to map disparate parts within a .xlsx package.  You can store this worksheet with the parts from the original .xlsx package, and still <br/>open succesfully in Excel if you were to zip the parts back up. On save, Excel will setup the references to sharedStrings again.</div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $sheet
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The worksheet with cells to be mapped to sharedStrings table.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $shared-strings
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The sharedStrings table.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
     at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
declare namespace ms = "http://schemas.openxmlformats.org/spreadsheetml/2006/main";
        
let $ss := fn:doc(excel:sharedstring-uri("/Default_xlsx_parts/"))/node()

let $ws:= (&lt;ms:worksheet&gt;
                &lt;ms:sheetData&gt;
                 &lt;ms:row&gt;
                   &lt;ms:c t="s"&gt;
                   &lt;ms:v&gt;1&lt;/ms:v&gt;
                 &lt;/ms:c&gt;
                &lt;/ms:row&gt;
               &lt;/ms:sheetData&gt;
           &lt;/ms:worksheet&gt;)

return excel:map-shared-strings($ws,$ss)
=&gt;
&lt;ms:worksheet xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:sheetData&gt;
      &lt;ms:row&gt;
	&lt;ms:c t="inlineStr"&gt;
	   &lt;ms:is&gt;&lt;ms:t&gt;TEST&lt;/ms:t&gt;&lt;/ms:is&gt;
	&lt;/ms:c&gt;
      &lt;/ms:row&gt;
   &lt;/ms:sheetData&gt;
&lt;/ms:worksheet&gt;

    
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                   <a id="ppt:uri-ppt-notes-master-rels"></a><b><font color="#c00831">
                   ppt:uri-ppt-notes-master-rels</font></b>(&nbsp;) as&nbsp;element(pr:Relationships)
                    </td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a package relationships element for the .xlsx package (_rels/.rels)
          </div><br>
          </td>
				</tr>
        
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">		    
xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:package-rels()
       =&gt;
&lt;Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"&gt;
   &lt;Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/&gt;
&lt;/Relationships&gt;
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-notes-masters-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-notes-masters-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $row-index as xs:integer, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $col-index as xs:integer
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function converts the row and column numbers from R1C1 notation (row/column notation) to A1
notation. <br/>Excel's limits for rows is 1048756, and for columns is 16384.
This function returns A1 notation for any cell in that range from A1 to
WID1048576. </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $row-index
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 the row index
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $col-index
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 the column index
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:r1c1-to-a1(1,2378)
=&gt;
CJL1 
 </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-notes-masters-rels-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-notes-masters-rels-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $cells as element(ms:c)+
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:row)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a worksheet row.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $cells
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
The cells to be populated within the row. It is assumed that all cells
have an A1 reference and that they are in the same row. The row number<br/>is determined by the row number identified by the cell. </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";


let $cell1 := excel:cell("A3",32999,(),0)
let $cell2 := excel:cell("B3",123)
let $cell3 := excel:cell("C3","Foo")
return excel:row(($cell1,$cell2,$cell3))
=&gt;
&lt;ms:row r="3" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:c r="A3" s="0"&gt;&lt;ms:v&gt;32999&lt;/ms:v&gt;&lt;/ms:c&gt;
   &lt;ms:c r="B3"&gt;&lt;ms:v&gt;123&lt;/ms:v&gt;&lt;/ms:c&gt;
   &lt;ms:c r="C3" t="inlineStr"&gt;&lt;ms:is&gt;&lt;ms:t&gt;Foo&lt;/ms:t&gt;&lt;/ms:is&gt;&lt;/ms:c&gt;
&lt;/ms:row&gt;


</pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-presentation"></a><b><font color="#c00831">
                 ppt:uri-ppt-presentation</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $worksheet as element(ms:worksheet), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $cells as element(ms:c)*
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:worksheet)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function sets the cells within the provided worksheet. If the cell
exists in the worksheet, it will be replaced. If the cell doesn't
exist, it will be set <br/>in the proper order within the proper row. If the
row doesn't exist, the row will be created and populated with the cell.
</div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $worksheet
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The worksheet where to set the cells.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $cells
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The cells to be set within $worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
declare namespace ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main";

let $cell1 := excel:cell("A1","foo")
let $cell2 := excel:cell("B3",123)
let $cell3 := excel:cell("A5",456)

let $worksheet :=
&lt;ms:worksheet&gt;	
   &lt;ms:sheetData&gt;
      &lt;ms:row r="1"&gt;
         &lt;ms:c r="A1"&gt;&lt;ms:v&gt;1&lt;/ms:v&gt;&lt;/ms:c&gt;
      &lt;/ms:row&gt;
      &lt;ms:row r="5"&gt;
         &lt;ms:c r="C5"&gt;&lt;ms:v&gt;1&lt;/ms:v&gt;&lt;/ms:c&gt;
      &lt;/ms:row&gt;
   &lt;/ms:sheetData&gt;
&lt;/ms:worksheet&gt;
return excel:set-cells($worksheet, ($cell1,$cell2,$cell3))
=&gt;
&lt;ms:worksheet xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:sheetData&gt;
      &lt;ms:row r="1"&gt;
         &lt;ms:c r="A1" t="inlineStr"&gt;&lt;ms:is&gt;&lt;ms:t&gt;foo&lt;/ms:t&gt;&lt;/ms:is&gt;&lt;/ms:c&gt;
      &lt;/ms:row&gt;
      &lt;ms:row r="3"&gt;
	 &lt;ms:c r="B3"&gt;&lt;ms:v&gt;123&lt;/ms:v&gt;&lt;/ms:c&gt;
      &lt;/ms:row&gt;
      &lt;ms:row r="5"&gt;
	 &lt;ms:c r="A5"&gt;&lt;ms:v&gt;456&lt;/ms:v&gt;&lt;/ms:c&gt;
	 &lt;ms:c r="C5"&gt;&lt;ms:v&gt;1&lt;/ms:v&gt;&lt;/ms:c&gt;
      &lt;/ms:row&gt;
   &lt;/ms:sheetData&gt;
&lt;/ms:worksheet&gt;

       
  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

declare namespace ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main";

let $cel1 := excel:cell("G23","bar")
let $worksheet :=
&lt;ms:worksheet&gt;	
   &lt;ms:sheetData&gt;
   &lt;/ms:sheetData&gt;
&lt;/ms:worksheet&gt;
return excel:set-cells($worksheet, ($cel1))
=&gt;
&lt;ms:worksheet xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;ms:sheetData&gt;
      &lt;ms:row r="23"&gt;
         &lt;ms:c r="G23" t="inlineStr"&gt;&lt;ms:is&gt;&lt;ms:t&gt;bar&lt;/ms:t&gt;&lt;/ms:is&gt;&lt;/ms:c&gt;
      &lt;/ms:row&gt;
   &lt;/ms:sheetData&gt;
&lt;/ms:worksheet&gt;
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-pres-props"></a><b><font color="#c00831">
                 ppt:uri-ppt-pres-props</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $directory as xs:string
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string*</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function returns the URI for the sharedString table, extracted from .xlsx using Open XML Extract pipeline.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $directory
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The name of the directory containing the extracted .xlsx parts.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml"; 
import module namespace excel= "http://marklogic.com/openxml/excel" 
at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:sharedstring-uri("/Default_xlsx_parts/")
=&gt;
/Default_xlsx_parts/xl/sharedStrings.xml
       
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-rels"></a><b><font color="#c00831">
                 ppt:uri-ppt-rels</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $directory as xs:string
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string*</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function returns only the worksheet URIs for files extracted from
.xlsx package using Open XML Extract pipeline. </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $directory
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The name of the directory containing the extracted .xlsx parts.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
	    
excel:sheet-uris("/Default_xlsx_parts/")
=&gt;
/Default_xlsx_parts/xl/worksheets/sheet1.xml
/Default_xlsx_parts/xl/worksheets/sheet2.xml
/Default_xlsx_parts/xl/worksheets/sheet3.xml

  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-slide"></a><b><font color="#c00831">
                 ppt:uri-ppt-slide</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $table-number as xs:integer, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $tablerange as xs:string, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $column-names as xs:string+, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$auto-filter as xs:boolean], 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$style as xs:boolean]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:table)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
	    This function creates a table element for a .xlsx package (xl/tables/table#.xml). Tables in SpreadsheetML, manifest themselves as Named Ranges in an Excel worksheet.  <br/>With these tables you can apply auto-formatting for columns, as well as styling.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $table-number
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number of the table.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $tablerange
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The ranger of the table in Excel notation A1-colon notation. ("A1:C3")
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $column-names
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The names of the columns.  These are the values from the first row in the cells found in $tablerange.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $auto-filter
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 If true, columns will have autofilter enabled.  Default true.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $style
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 If true, simple style of TableStyleMedium10 is applied to table. Default none.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:table(1,"A1:C3",("Heading1","Heading2","Heading3"))
=&gt;
&lt;table id="1" name="Table1" displayName="Table1" ref="A1:C3" totalsRowShown="0" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;autoFilter ref="A1:C3"/&gt;
   &lt;tableColumns count="3"&gt;
      &lt;tableColumn id="1" name="Heading1"/&gt;
      &lt;tableColumn id="2" name="Heading2"/&gt;
      &lt;tableColumn id="3" name="Heading3"/&gt;
   &lt;/tableColumns&gt;
&lt;/table&gt;

  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:table(1,"A1:C3",("Heading1","Heading2","Heading3"),xs:boolean("false"),xs:boolean("true"))
=&gt;
&lt;table id="1" name="Table1" displayName="Table1" ref="A1:C3" totalsRowShown="0" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;tableColumns count="3"&gt;
       &lt;tableColumn id="1" name="Heading1"/&gt;
       &lt;tableColumn id="2" name="Heading2"/&gt;
       &lt;tableColumn id="3" name="Heading3"/&gt;&lt;/tableColumns&gt;
   &lt;tableStyleInfo name="TableStyleMedium10" showFirstColumn="0" showLastColumn="0" showRowStripes="1" showColumnStripes="0"/&gt;
&lt;/table&gt;
       
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-slide-layout"></a><b><font color="#c00831">
                 ppt:uri-ppt-slide-layout</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $worksheet-count as xs:integer
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:workbook)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a workbook element for the .xlsx package (xl/workbook.xml) 
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $worksheet-count
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number of worksheets in the workbook.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">		    
xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

excel:workbook(3)
=&gt;
&lt;workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"&gt;
   &lt;sheets&gt;
      &lt;sheet name="Sheet1" sheetId="1" r:id="rId1"/&gt;
      &lt;sheet name="Sheet2" sheetId="2" r:id="rId2"/&gt;
      &lt;sheet name="Sheet3" sheetId="3" r:id="rId3"/&gt;
   &lt;/sheets&gt;
&lt;/workbook&gt;
       
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-slide-layout-rels"></a><b><font color="#c00831">
                 ppt:uri-ppt-slide-layout-rels</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $worksheet-count as xs:integer
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(pr:Relationships)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a workbook relationships element for the .xlsx package (xl/_rels/workbook.xml.rels)
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $worksheet-count
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number of worksheets in the workbook.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">		    
xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:workbook-rels(3) 
=&gt;
&lt;Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"&gt;
   &lt;Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/&gt;
   &lt;Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet2.xml"/&gt;
   &lt;Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet3.xml"/&gt;
&lt;/Relationships&gt;
      
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-slide-layout-rels-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-slide-layout-rels-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $workbook as element(ms:workbook)
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;xs:string*</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function returns the iworksheet names for the workbook.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $workbook
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The workbook.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

let $workbook := fn:doc("/Default_xlsx_parts/xl/workbook.xml")/node()
return
  excel:workbook-sheet-names($workbook)
=&gt;
Sheet1
Sheet2
Sheet3


		  
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="ppt:uri-ppt-slide-layouts-dir"></a><b><font color="#c00831">
                 ppt:uri-ppt-slide-layouts-dir</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $rows as element(ms:row)*, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$colwidths as element(ms:cols)?], 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$tbl-count as xs:integer]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(ms:worksheet)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function creates a worksheet for the .xlsx package (xl/worksheets/sheet#.xml)
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $rows
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The rows for the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $colwidths
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The custom column widths for the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $tbl-count
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number of tables associated with the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
let $cells := ((excel:cell("A1",1), 
                excel:cell("B1",2), 
                excel:cell("C1",3)))
let $row := excel:row($cells)
return excel:worksheet($row)
=&gt;
&lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;sheetData&gt;
      &lt;row r="1" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
         &lt;c r="A1"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;
         &lt;c r="B1"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;
         &lt;c r="C1"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;
      &lt;/row&gt;
   &lt;/sheetData&gt;
&lt;/worksheet&gt; 
  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
let $cells := ((excel:cell("A1",1), 
                excel:cell("B1",2), 
                excel:cell("C1",3)))
let $row := excel:row($cells)
let $colwidths := excel:column-width((25,25,25))
return excel:worksheet($row,$colwidths)
=&gt;
&lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;sheetData&gt;
      &lt;cols&gt;
         &lt;col min="1" max="1" width="25" customWidth="1"/&gt;
         &lt;col min="2" max="2" width="25" customWidth="1"/&gt;
         &lt;col min="3" max="3" width="25" customWidth="1"/&gt;
      &lt;/cols&gt;		
      &lt;row r="1" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
         &lt;c r="A1"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;
         &lt;c r="B1"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;
         &lt;c r="C1"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;
      &lt;/row&gt;
   &lt;/sheetData&gt;
&lt;/worksheet&gt;
       

  </pre>
  
            </div>
            </td>
				</tr><tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
let $cells := ((excel:cell("A1",1), 
                excel:cell("B1",2), 
                excel:cell("C1",3)))
let $row := excel:row($cells)
let $colwidths := excel:column-width((25,25,25))
return excel:worksheet($row,$colwidths,2)
=&gt;
&lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
   &lt;cols&gt;
      &lt;col min="1" max="1" width="25" customWidth="1"/&gt;
      &lt;col min="2" max="2" width="25" customWidth="1"/&gt;
      &lt;col min="3" max="3" width="25" customWidth="1"/&gt;
   &lt;/cols&gt;	
   &lt;sheetData&gt;
      &lt;row r="1" xmlns:ms="http://schemas.openxmlformats.org/spreadsheetml/2006/main"&gt;
         &lt;c r="A1"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;
         &lt;c r="B1"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;
         &lt;c r="C1"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;
      &lt;/row&gt;
   &lt;/sheetData&gt;
   &lt;tableParts count="2"&gt;
      &lt;tablePart r:id="rId1"/&gt;
      &lt;tablePart r:id="rId2"/&gt;
   &lt;/tableParts&gt;
&lt;/worksheet&gt;
       

  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="excel:worksheet-rels"></a><b><font color="#c00831">
                 excel:worksheet-rels</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $start-ind as xs:integer, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $tbl-count as xs:integer
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(pr:Relationships)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function createts a worksheet relationships element for a .xlsx package (xl/worksheets/_rels/sheet#.xml.rels)
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $start-ind
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The starting index for tables relating to the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $tbl-count
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The number of tables relating to the worksheet.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
       
excel:worksheet-rels(2,2)
       =&gt;
&lt;Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"&gt;
   &lt;Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table2.xml"/&gt;
   &lt;Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table3.xml"/&gt;
&lt;/Relationships&gt;
       
       
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="excel:xlsx-package"></a><b><font color="#c00831">
                 excel:xlsx-package</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $content-types as element(types:Types), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $workbook as element(ms:workbook), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $rels as element(pr:Relationships), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $workbookrels as element(pr:Relationships), 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $sheets as element(ms:worksheet)*, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$worksheetrels as element(pr:Relationships)*], 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      [$table as element(ms:table)*]
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;binary()</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
This function creates a .zip file that is the .xlsx package containing
the parts passed in as parameters. It is assumed the parts are properly
mapped to one another. <br/>Just using the constructors provided, and setting the number of worksheets, its possible to generate workbooks dynamically.  It's also quite simple to add a named range <br/>to a single worksheet. It can get a little tricker when adding multiple tables to multiple worksheets, but we've aimed to simplify workbook construction for you with the constructors provided.<br/><br/>
<i>  Some things to remember: Worksheets will appear in the Workbook in the order they are added within their sequence.  Tables must have unique names, and <br/>unique relationship ids.  (the constructor accounts for this by letting you add tables by number, as that's how they'll be saved within the .xlsx package natively.)  <br/>Every table must also have a worksheet relationship defined. Each worksheet has its own worksheet relationships filed saved within the .xlsx package.  <i/></div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $content-types
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The [Content_Types].xml part.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $workbook
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The workbook.xml part.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $rels
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The package Relationships part.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $workbookrels
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The workbook Relationships part.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $sheets
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The worksheet (sheetN.xml) parts.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $worksheetrels
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The sheetN.xml Relationships parts. (Required when mapping tables to sheets.)
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $table
                   <font style="font-size: 10pt; font-family: Arial;"> 
                       (optional)</font>:
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The table.xml parts. (Used for named ranges, auto-filtering columns, styling, etc.)
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
       at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";
declare namespace ms = "http://schemas.openxmlformats.org/spreadsheetml/2006/main";

let $worksheets:= (&lt;ms:worksheet&gt;
                    &lt;ms:sheetData&gt;
                     &lt;ms:row&gt;
                       &lt;ms:c&gt;
                        &lt;ms:v&gt;1&lt;/ms:v&gt;
                       &lt;/ms:c&gt;
                     &lt;/ms:row&gt;
                    &lt;/ms:sheetData&gt;
                  &lt;/ms:worksheet&gt;)

let $ws-count := fn:count($worksheets)
let $content-types := excel:content-types($ws-count,0)
let $workbook := excel:workbook($ws-count)
let $rels :=  excel:package-rels()
let $workbookrels :=  excel:workbook-rels($ws-count)
let $package := excel:xlsx-package($content-types, $workbook, $rels, $workbookrels, $worksheets)

return xdmp:zip-manifest($package)
=&gt;
&lt;parts xmlns="xdmp:zip"&gt;
  &lt;part uncompressed-size="499" compressed-size="218" encrypted="false"&gt;[Content_Types].xml&lt;/part&gt;
  &lt;part uncompressed-size="229" compressed-size="146" encrypted="false"&gt;xl/workbook.xml&lt;/part&gt;
  &lt;part uncompressed-size="241" compressed-size="140" encrypted="false"&gt;_rels/.rels&lt;/part&gt;
  &lt;part uncompressed-size="242" compressed-size="144" encrypted="false"&gt;xl/_rels/workbook.xml.rels&lt;/part&gt;
  &lt;part uncompressed-size="172" compressed-size="115" encrypted="false"&gt;xl/worksheets/sheet1.xml&lt;/part&gt;
&lt;/parts&gt;
    
  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
        </tbody></table><table class="mainbody" width="100%" border="0" cellpadding="0" cellspacing="0">

        <tbody><tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12">
      <hr class="control-line" size="1"></td>
				</tr>

        <tr class="mainbody">
				  <td>

            <table>
            <tbody><tr>
					<td colspan="2" style="font-size: 12pt; font-family: Courier;">
                 <a id="excel:xlsx-manifest"></a><b><font color="#c00831">
                 excel:xlsx-manifest</font></b>(
                    </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $directory as xs:string, 
                      </td>
				      </tr><tr>
					<td width="20"></td>
					<td style="font-size: 11pt; font-family: Courier;">
                      $uris as xs:string*
                      </td>
				      </tr><tr>
					<td colspan="2" style="font-size: 11pt; font-family: Courier;">)&nbsp; as &nbsp;element(zip:parts)</td>
				      </tr>
            </tbody></table>

          </td>
				</tr>

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" height="12"></td>
				</tr>

        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
          <img src="images/varspace.gif" width="8">
          <b>Summary:</b>
          <div style="margin-left: 0.5in; margin-right: 8px; font-family: arial; font-size: 10pt;"> <br>
            This function constructs a manifest for the given URIs in the directory.
          </div><br>
          </td>
				</tr>
        <tr class="mainbody">
				  <td style="font-size: 10pt; font-family: Arial;">
    <img src="images/varspace.gif" width="8">
    <b>Parameters:</b>
      <table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $directory
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The name of the directory.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><table>
          <tbody><tr class="mainbody">
					<td style="font-size: 11pt; font-family: Arial;">
               <img src="images/varspace.gif" width="8">
                 <div style="margin-left: 0.5in; margin-right: 8px;">
                 <font style="font-size: 11pt; font-family: Courier;">
                   $uris
                   :
                 </font>
                 <font style="font-family: arial; font-size: 10pt;">
                 The URIs within the directory to be listed in the manifest.
                 </font>
                 </div> 
            </td>
				      </tr>
         </tbody></table><br>
    </td>
				</tr>
 
        

        

        <tr class="mainbody">
				  <td><img src="images/varspace.gif" width="8">
            <font style="font-size: 10pt; font-family: Arial;"><b>Example:</b></font>
            <div style="margin-left: 0.5in; margin-right: 8px; font-size: 9pt; font-family: Courier;"> 
            <pre xml:space="preserve">xquery version "1.0-ml";
import module namespace excel= "http://marklogic.com/openxml/excel" 
    at "/MarkLogic/openxml/spreadsheet-ml-support.xqy";

let $uris := ("/Default_xlsx_parts/xl/workbook.xml",
              "/Default_xlsx_parts/xl/worksheets/Sheet1.xml",
              "/Default_xlsx_parts/[Content_Types].xml",
              "/Default_xlsx_parts/_rels/.rels")

return excel:xlsx-manifest("/Default_xlsx_parts/",$uris)
=&gt;
&lt;parts xmlns="xdmp:zip"&gt;
  &lt;part&gt;xl/workbook.xml&lt;/part&gt;
  &lt;part&gt;xl/worksheets/Sheet1.xml&lt;/part&gt;
  &lt;part&gt;[Content_Types].xml&lt;/part&gt;
  &lt;part&gt;_rels/.rels&lt;/part&gt;
&lt;/parts&gt;
    

  </pre>
  
            </div>
            </td>
				</tr>

        <tr class="mainbody">
				  <td></td>
				</tr>
		</tbody></table>-->
       </td>
			  </tr>







      </tbody></table>
      </td>
		    </tr>
  </tbody></table>
    </td>
	      </tr>
  </tbody></table>
  </td>
	</tr>
</tbody></table>
      <table width="100%" align="left" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="middle" height="30">
	  <td class="copyright" style="padding-left: 10px;">
         Copyright 2002-2009 Mark Logic Corporation.&nbsp;&nbsp;All rights reserved.
      </td>
	</tr></tbody></table>
    </form>
</body></html>
